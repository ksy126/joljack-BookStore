<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="main">

	<select id="selectProductList" parameterType="map" resultType="cmd.vo.ProductVO">
		SELECT
			*
		FROM
			product
		where
			1=1
			<choose>
				<when test="category == 'fiction'">
					AND p_category = 'fiction'
				</when>
				<when test="category == 'top'">
					AND p_category = 'top'
				</when>
				<when test="category == 'shirt'">
					AND p_category = 'shirt'
				</when>
				<when test="category == 'pants'">
					AND p_category = 'pants'
				</when>
				<when test="category == 'acc'">
					AND p_category = 'acc'
				</when>
				<otherwise>
					AND 2=2
				</otherwise>
			</choose>
			<if test="search != null ">
				AND p_name LIKE CONCAT('%', #{search}, '%')
			</if>
		ORDER by
			<choose>
				<when test="type == 'new'">
					p_insert_date DESC
				</when>
				<when test="type == 'best'">
					p_buy_amount DESC
				</when>
				<when test="type == 'highPrice'">
					p_price DESC
				</when>
				<when test="type == 'lowPrice'">
					p_price ASC
				</when>
				<otherwise>
					p_insert_date DESC
				</otherwise>
			</choose>
		LIMIT #{po}, #{ps}
	</select>

	<update id="updateQaInfo" parameterType="map">
		UPDATE
		qa
		SET
		qa_title = #{qa_title}
		, qa_content = #{qa_content}
		WHERE
		qa_no = #{qa_no}
	</update>

	<insert id="insertQaInfo" parameterType="map">
		INSERT INTO
		qa
		(
		member_no
		, qa_title
		, qa_content
		, qa_insertDate
		)
		VALUES
		(
		#{member_no}
		, #{qa_title}
		, #{qa_content}
		, NOW()
		)
	</insert>

	<insert id="naviInfoInsert" parameterType="map">
		INSERT INTO
		navi
		(
		member_no
		, product_no
		, insertDate
		)
		VALUES
		(
		#{member_no}
		, #{product_no}
		, #{insertDate}
		)
	</insert>

	<select id="selectQaList" parameterType="map" resultType="cmd.vo.QaVO">
		SELECT
		q.qa_no
		, q.member_no
		, q.qa_title
		, q.qa_content
		, q.qa_insertDate
		, q.qa_answer
		, m.name
		FROM
		qa q
		, member m
		WHERE
		q.member_no = m.member_no
		ORDER BY q.qa_insertDate DESC
		LIMIT #{po}, #{ps}
	</select>

	<select id="selectQaNo" parameterType="map" resultType="cmd.vo.QaVO">
		SELECT
		q.qa_no
		, q.member_no
		, q.qa_title
		, q.qa_content
		, q.qa_insertDate
		, q.qa_answer
		, m.name
		FROM
		qa q
		, member m
		WHERE
		q.member_no = m.member_no
		AND
		q.qa_no = #{qa_no}
	</select>

	<select id="selectNoticeList" parameterType="map" resultType="cmd.vo.NoticeVO">
		SELECT
		*
		FROM
		notice
		ORDER BY notice_insertDate DESC
		LIMIT #{po}, #{ps}
	</select>

	<select id="selectNoticeNo" parameterType="map" resultType="cmd.vo.NoticeVO">
		SELECT
		*
		FROM
		notice
		WHERE
		notice_no = #{notice_no}
	</select>

	<delete id="qaDelete" parameterType="map">
		DELETE FROM
		qa
		WHERE
		qa_no = #{qa_no}
	</delete>

</mapper>